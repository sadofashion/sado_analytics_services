version: 2

sources:
  - name: analytics
    description: "Google Analytics 4 export"
    database: agile-scheme-394814
    schema: analytics_336884118
    tables:
      - name: events
        identifier: events_*
        loaded_at_field: "case when _table_suffix like '%intraday%' then parse_timestamp('%Y%m%d',regexp_replace(_table_suffix,r'^intraday_','')) else parse_timestamp('%Y%m%d',_table_suffix) end"
        freshness:
          warn_after:
            count: 24
            period: hour
          error_after:
            count: 36
            period: hour