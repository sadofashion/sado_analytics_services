version: 2
models:
  - name: stg_5sfashion__orders
    meta:
      joins:
        - join: calendar
          sql_on: date(${stg_5sfashion__orders.transaction_date}) = ${calendar.date}
    columns:
      - name: total
        data_type: float64
        quote: true
        description: ""
        meta:
          dimension:
            type: number
            hiddne: true
          metrics:
            m_revenue:
              type: sum
              label: "total revenue"
              compact: thousands
              round: 0
              filters:
                - status: "!Cancelled"
            
      - name: id
        description: ""
        meta:
          dimension:
            type: number
      - name: code
        description: ""
        meta:
          dimension:
            type: string
          metrics:
            m_orders:
              type: count
              label: "total confirmed orders"
              compact: thousands
              round: 0
              filters:
                - status: "!Cancelled"
            m_cancelled_orders:
              type: count
              label: "total cancelled orders"
              compact: thousands
              round: 0
              filters:
                - status: "Cancelled"
      - name: total_discount
        description: ""
        meta:
          dimension:
            type: number
            hiddne: true
          metrics:
            m_total_discount:
              type: sum
              label: "total discount"
              compact: thousands
              round: 0
              filters:
                - status: "!Cancelled"
      - name: original_price
        description: ""
        meta:
          dimension:
            type: number
            hiddne: true
          metrics:
            m_original_price:
              type: sum
              label: "total revenue before discount"
              compact: thousands
              round: 0
              filters:
                - status: "!Cancelled"
      - name: shipping_fee
        description: ""
        meta:
          dimension:
            type: number
            hiddne: true
          metrics:
            m_shipping_fee:
              type: sum
              label: "total shipping fee"
              compact: thousands
              round: 0
              filters:
                - status: "!Cancelled"
      - name: transaction_date
        description: ""
        meta:
          dimension:
            type: timestamp
            hidden: true
          additional_dimensions:
            d_transaction_date:
              type: date
              label: "Transaction date"
              sql: "DATE(${TABLE}.transaction_date)"
      - name: invoice_id
        description: ""
        meta:
          dimension:
            type: string
      - name: status
        description: ""
        meta:
          dimension:
            type: string
