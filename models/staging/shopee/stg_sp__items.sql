{
   "attribute_list": [
      {
         "attribute_id": 100037,
         "attribute_value_list": [
            {
               "original_value_name": "Vietnam",
               "value_id": 136,
               "value_unit": ""
            }
         ],
         "is_mandatory": false,
         "original_attribute_name": "Region of Origin"
      },
      {
         "attribute_id": 100134,
         "attribute_value_list": [
            {
               "original_value_name": "Poly x Spandex",
               "value_id": 0,
               "value_unit": ""
            }
         ],
         "is_mandatory": false,
         "original_attribute_name": "Material"
      },
      {
         "attribute_id": 100155,
         "attribute_value_list": [
            {
               "original_value_name": "Casual",
               "value_id": 1387,
               "value_unit": ""
            }
         ],
         "is_mandatory": false,
         "original_attribute_name": "Occasion"
      },
      {
         "attribute_id": 100162,
         "attribute_value_list": [
            {
               "original_value_name": "Plain",
               "value_id": 1463,
               "value_unit": ""
            },
            {
               "original_value_name": "Print",
               "value_id": 1486,
               "value_unit": ""
            }
         ],
         "is_mandatory": false,
         "original_attribute_name": "Pattern"
      },
      {
         "attribute_id": 100169,
         "attribute_value_list": [
            {
               "original_value_name": "Basic",
               "value_id": 1504,
               "value_unit": ""
            }
         ],
         "is_mandatory": false,
         "original_attribute_name": "Style"
      },
      {
         "attribute_id": 100171,
         "attribute_value_list": [
            {
               "original_value_name": "Mid Waist",
               "value_id": 1534,
               "value_unit": ""
            }
         ],
         "is_mandatory": false,
         "original_attribute_name": "Waist Height"
      },
      {
         "attribute_id": 100177,
         "attribute_value_list": [
            {
               "original_value_name": "Jersey",
               "value_id": 1587,
               "value_unit": ""
            }
         ],
         "is_mandatory": false,
         "original_attribute_name": "Shorts Type"
      }
   ],
   "brand": {
      "brand_id": 4266489,
      "original_brand_name": "5S FASHION"
   },
   "category_id": 100053,
   "compatibility_info": {},
   "condition": "NEW",
   "create_time": 1722394529,
   "deboost": "FALSE",
   "description_info": {
      "extended_description": {
         "field_list": [
            {
               "field_type": "text",
               "text": "Quần Short Thể Thao Nam 5S Fashion Cạp Chun Co Giãn QST24004\nQuần short nam 5S Project là sản phẩm quần short thể thao nam nằm trong BST True Sport của 5S Fashion. Quần có 3 màu với các tone màu lạnh - màu của mùa Hè, giúp cho người mặc cảm thấy mát mẻ, dễ chịu và dễ dàng mit&match.\n- Quần được may với phom dáng Regular Fit - thoải mái nhưng vẫn đảm bảo sự gọn gàng khi vận động và tôn dáng người mặc\n- Hai bên sườn may can cắt, in chữ lớn 5S PROJECT phía sau ép nhiệt khỏe khoắn, nổi bật\n- Cạp chun chắc chắn co giãn theo vòng bụng cho bạn cảm giác dễ chịu và thoải mái nhất\n- Túi hai bên sâu rộng tiện lợi có khóa kéo trơn tru, cao cấp\n- Đường may đều, tỉ mỉ, không chỉ thừa.\nTổng thể thiết kế basic dễ mặc mang lại cho phái mạnh vẻ ngoài mạnh mẽ và khỏe khoắn, bạn có thể mặc ở nhà, đi chơi, đi dạo và đặc biệt phù hợp cho các hoạt động vận động thể thao.\nChất liệu thể thao cao cấp: \n- Polyester: chất liệu tổng hợp cao cấp, các sợi vải được chuốt mảnh với cấu trúc dệt lưới tạo rãnh thoáng khí giúp nhiệt và độ ẩm lưu thông nhanh chóng, khuếch tán ra bên ngoài. Nhờ đó người mặc sẽ luôn có cảm giác mềm mát khi chạm vào, cảm nhận được sự thoáng mát, không bết dính và nhẹ nhàng, êm ái.\n- Spandex: co giãn dễ chịu, chất đàn hồi giúp hạn chế bai gião.\nĐây là dòng chất liệu được ưa chuộng trong sản xuất đồ thể thao.\nMàu sắc : Xanh đá đậm, Ghi nhạt, Đen\nSize: S, M, L, XL, 2XL, 3XL\n\n"
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o7x8yp74",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o7x8yp74"
               }
            },
            {
               "field_type": "text",
               "text": "\n\n"
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o7ynj51c",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o7ynj51c"
               }
            },
            {
               "field_type": "text",
               "text": "\n\n"
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o8023l41",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o8023l41"
               }
            },
            {
               "field_type": "text",
               "text": "\n\n"
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o81go1dc",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o81go1dc"
               }
            },
            {
               "field_type": "text",
               "text": "\n\n"
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o82v8h1f",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o82v8h1f"
               }
            },
            {
               "field_type": "text",
               "text": "\n\n"
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o849sx89",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o849sx89"
               }
            },
            {
               "field_type": "text",
               "text": "\n\n"
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o88hi996",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o88hi996"
               }
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o85odd9c",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o85odd9c"
               }
            },
            {
               "field_type": "image",
               "image_info": {
                  "image_id": "vn-11134208-7r98o-lyd4h5o872xtbd",
                  "image_url": "https://cf.shopee.vn/file/vn-11134208-7r98o-lyd4h5o872xtbd"
               }
            },
            {
               "field_type": "text",
               "text": "\n** Cảm ơn quý khách hàng đã tin tưởng và đồng hành cùng shop. Chúc bạn có một ngày mua sắm thật thoải mái nhé! Đừng ngần ngại nhắn tin cho shop để được hỗ trợ nhanh nhất bạn nhé!\n#quan_short_nam #quan_dui_nam #quan_dui_nam #quan_nam_dep #quan_short_gio_nam_the_thao #quan_short_gio_nam #quan_dui_nam_hang_hieu #quan_nam_ngan #quan_gio_nam #quan_short_thun_nam #quan_short_nam_the_thao #quan_dui_gio_nam #quan_short_nam_cao_cap #quan_short_nam_mac_nha #quan_nam_ngan_thun #quan_dui_nam_gio #quan_short_gio #quan_short_the_thao_cai_cuc"
            }
         ]
      }
   },
   "description_type": "extended",
   "dimension": {
      "package_height": 3,
      "package_length": 32,
      "package_width": 24
   },
   "has_model": true,
   "image": {
      "image_id_list": [
         "vn-11134207-7r98o-lyd4fuwadh9dc0",
         "vn-11134207-7r98o-lyd4g4cgjo7hd9",
         "vn-11134207-7r98o-lyd4g4gcdztt76",
         "vn-11134207-7r98o-lyd4g4hgdrnx1e",
         "vn-11134207-7r98o-lyd4g4i0bk4hda",
         "vn-11134207-7r98o-lyd4g4lw5v7x1d",
         "vn-11134207-7r98o-lyd4g47qqkyp13",
         "vn-11134207-7r98o-lyd4gas561lt23"
      ],
      "image_ratio": "1:1",
      "image_url_list": [
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4fuwadh9dc0",
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4g4cgjo7hd9",
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4g4gcdztt76",
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4g4hgdrnx1e",
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4g4i0bk4hda",
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4g4lw5v7x1d",
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4g47qqkyp13",
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4gas561lt23"
      ]
   },
   "item_dangerous": 0,
   "item_id": 26906648901,
   "item_name": "[HĐ 399K TẶNG SỊP] Quần Short Thể Thao Nam 5S FASHION In Chữ Khỏe Khoắn, Phom Regular Thoải Mái (QST24004)",
   "item_sku": "",
   "item_status": "NORMAL",
   "logistic_info": [
      {
         "enabled": true,
         "is_free": false,
         "logistic_id": 5000,
         "logistic_name": "Hỏa Tốc",
         "size_id": 0
      },
      {
         "enabled": true,
         "is_free": false,
         "logistic_id": 5004,
         "logistic_name": "Hàng Cồng Kềnh",
         "size_id": 0
      },
      {
         "enabled": true,
         "is_free": false,
         "logistic_id": 5002,
         "logistic_name": "Tiết kiệm",
         "size_id": 0
      },
      {
         "enabled": true,
         "is_free": false,
         "logistic_id": 5001,
         "logistic_name": "Nhanh",
         "size_id": 0
      }
   ],
   "pre_order": {
      "days_to_ship": 2,
      "is_pre_order": false
   },
   "promotion_id": 218023865159837,
   "promotion_image": {
      "image_id_list": [
         "vn-11134207-7r98o-lyd4fuwadh9dc0"
      ],
      "image_url_list": [
         "https://cf.shopee.vn/file/vn-11134207-7r98o-lyd4fuwadh9dc0"
      ]
   },
   "size_chart": "",
   "size_chart_id": 0,
   "update_time": 1723023508,
   "weight": "0.25"
}

with source as (
    {{
        dbt_utils.deduplicate(
            relation = source('shopee', 'item_list'), 
            partition_by = 'id', 
            order_by = '_batched_at desc'
            )
            }}
)

select 
json_value(o.data,'$.item_id') as item_id,
json_value(o.data,'$.item_name') as item_name,
json_value(o.data,'$.item_sku') as item_sku,
json_value(o.data,'$.item_status') as item_status,
json_value(o.data,'$.category_id') as category_id,
json_value(o.data,'$.brand.brand_id') as brand_id,
json_value(o.data,'$.brand.original_brand_name') as brand_name,

from source