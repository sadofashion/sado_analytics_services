version: 2
models:
  - name: dim__branches
    columns:
      - name: asm_name
        description: ""
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: branch_id
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
        data_type: NUMERIC
      - name: branch_name
        description: ""
        meta:
          dimension:
            type: string
          additional_dimensions:
            d_source:
              type: string
              sql: |
                case when ${channel} = 'Offline' then ${asm_name} 
                when ${channel} = 'Online & Ecom' and ${branch_name} in ('Website','FB - WEB') then 'Website'
                when ${channel} = 'Online & Ecom' and ${branch_name} in ('Facebook','Instagram') then 'Social'
                when ${channel} = 'Online & Ecom' and ${branch_name} in ('Tiktok Shop','Lazada.vn','Shopee.vn','Tiki.vn','Sàn','Zalo Shop') then 'Ecom Platform'
                else ${branch_name} end
              label: Source
        data_type: STRING
      - name: phone
        description: ""
        meta:
          dimension:
            type: string
            hidden: true
        data_type: STRING
      - name: email
        description: ""
        meta:
          dimension:
            type: string
            hidden: true
        data_type: STRING
      - name: local_page
        description: ""
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: region_page
        description: ""
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: fb_ads_pic
        description: ""
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: province
        description: ""
        meta:
          dimension:
            type: string
          additional_dimensions:
            d_province:
              type: string
              sql: case when ${province} is null then 'Chưa phân loại' else ${province} end
              label: Province group
        data_type: STRING
      - name: region
        description: ""
        meta:
          dimension:
            type: string
          additional_dimensions:
            d_region:
              type: string
              sql: case when ${region} is null then 'Chưa phân loại' else ${region} end
              label: Region group
        data_type: STRING
      - name: channel
        description: ""
        meta:
          dimension:
            type: string
      - name: opening_day
        description: ""
        meta:
          dimension:
            type: date
      - name: close_date
        description: ""
        meta:
          dimension:
            type: date
    description: Tổng hợp CH Online & Offline
