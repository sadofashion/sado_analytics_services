version: 2
models:
  - name: fct__working_days
    columns:
      - name: branch_working_day_id
        description: >-
          This is a unique identifier for each working day at a specific branch.
          It is generated by hashing the branch_id and the date. This identifier
          is useful for tracking and analyzing the performance of each branch on
          a daily basis.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
            hidden: true
      - name: branch_id
        description: >-
          This is a unique numeric identifier for each branch. It is used to
          distinguish between different branches in the company's network.
        data_type: numeric
        quote: true
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_operating_days:
              type: count
              label: Operating Days
      - name: branch_name
        description: >-
          This is the name of the branch. It provides a human-readable
          identifier for each branch, making it easier for business users to
          understand and analyze the data.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
          additional_dimensions:
            d_source:
              type: string
              sql: |
                case when ${channel} = 'Offline' then ${asm_name} 
                when ${channel} = 'Online & Ecom' and ${branch_name} in ('Website','FB - WEB','5S Web') then 'Website'
                when ${channel} = 'Online & Ecom' and ${branch_name} in ('Facebook','Instagram') then 'Social'
                when ${channel} = 'Online & Ecom' and ${branch_name} in ('Tiktok Shop','Lazada.vn','Shopee.vn','Tiki.vn','Sàn','Zalo Shop') then 'Sàn'
                else ${branch_name} end
              label: Source
      - name: branch_code
        description: >-
          This is a unique identifier for each branch in the business. It is
          used to track and manage the operations of each branch separately.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
            hidden: true
      - name: channel
        description: >-
          This refers to the medium or platform through which the business
          interacts with its customers. It could be online, in-store, or any
          other method of interaction.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: asm_name
        description: >-
          This is the name of the Area Sales Manager responsible for the branch.
          It is used to track the performance and accountability of each manager
          in the business.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: local_page
        description: >-
          This column represents the name of the local page associated with the
          branch. It is a string type and can be used to identify the specific
          local page for marketing or other business purposes.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: local_page_code
        description: >-
          This column represents the unique code associated with the local page.
          It is a string type and can be used for data analysis and tracking
          purposes.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
            hidden: true
      - name: region_page
        description: >-
          This column represents the name of the regional page associated with
          the branch. It is a string type and can be used to identify the
          specific regional page for marketing or other business purposes.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: fb_ads_pic
        description: >-
          This column contains the URL of the Facebook advertisement picture
          associated with the branch. This is used for marketing and promotional
          purposes.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: province
        description: >-
          This column represents the province where the branch is located. It is
          useful for geographical analysis and segmentation.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: region
        description: >-
          This column represents the region where the branch is located. It is a
          broader geographical classification than province and is useful for
          regional analysis and segmentation.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: opening_day
        description: >-
          This column represents the date when a particular branch was opened.
          It is in the date format (YYYY-MM-DD). This information is crucial for
          understanding the operational timeline of the branch.
        data_type: date
        quote: true
        meta:
          dimension:
            type: date
            hidden: true
          additional_dimensions:
            d_opening_month:
              type: string
              sql: format_date('%Y-%m',opening_day)
              label: Opening Month
            d_opening_year:
              type: string
              sql: format_date('%Y',opening_day)
              label: Opening Year
            d_opening_quarter:
              type: string
              sql: format_date('%Y-Q%Q',opening_day)
              label: Opening Quarter
            d_store_age:
              type: number
              sql: date_diff( CURRENT_DATE(), opening_day, month)
              label: Store Age
            d_store_age_group:
              type: number
              sql: >- 
                case 
                  when date_diff( date, opening_day, month) <= 3 then 'a. 0-3 Months'
                  when date_diff( date, opening_day, month) <= 6 then 'b. 4-6 Months'
                  when date_diff( date, opening_day, month) <= 12 then 'c. 7-12 Months'
                  when date_diff( date, opening_day, month) <= 18 then 'd. 1-1.5 Years'
                  when date_diff( date, opening_day, month) <= 24 then 'e. 1.5-2 Years'
                  when date_diff( date, opening_day, month) <= 36 then 'f. 2-3 Years'
                  else 'g. 3+ Years' end
              label: Store Age Group
      - name: close_date
        description: >-
          This column represents the date when a particular branch was closed.
          It is also in the date format (YYYY-MM-DD). If the branch is still
          operational, this field will be NULL. This information helps in
          understanding the lifespan of the branch.
        data_type: date
        quote: true
        meta:
          dimension:
            type: date
            hidden: true
          additional_dimensions:
            d_is_currently_active:
              type: string
              sql: case when close_date is null then 'Yes' else 'No' end
              label: Currently Active
      - name: model_type
        description: >-
          This column represents the type of the branch model. It is a string
          value that can provide insights into the operational model of the
          branch. This information can be used to categorize branches and
          analyze performance based on the model type.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: date
        description: >-
          This column represents the specific date of the working day for a
          particular branch. It is in the format of YYYY-MM-DD. This field is
          crucial for time-based analysis and reporting.
        data_type: date
        quote: true
        meta:
          dimension:
            type: date
      - name: day_of_month
        description: >-
          This column indicates the day of the month for the working day. It is
          a numeric field ranging from 1 to 31. This field can be used to
          analyze trends and patterns that occur on specific days of the month.
        data_type: int64
        quote: true
        meta:
          dimension:
            type: number
      - name: day_name
        description: >-
          This column provides the name of the day of the week (e.g., Monday,
          Tuesday, etc.) for the working day. This field can be used to analyze
          trends and patterns that occur on specific days of the week.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: start_of_month
        description: >-
          This column represents the first day of the month for the given date.
          It is useful for monthly reporting and analysis, allowing business
          users to easily group data by month.
        data_type: date
        quote: true
        meta:
          dimension:
            type: date
      - name: end_of_month
        description: >-
          This column represents the last day of the month for the given date.
          It is useful for monthly reporting and analysis, especially when
          determining the end of a specific business period.
        data_type: date
        quote: true
        meta:
          dimension:
            type: date
      - name: month_name
        description: >-
          This column contains the name of the month for the given date. It
          provides a more human-readable format for dates, making it easier for
          business users to understand and interpret the data.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: year_month
        description: >-
          This column represents the year and month of the working day in the
          format 'YYYY-MM'. It is useful for aggregating data on a monthly
          basis.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: year_quarter
        description: >-
          This column represents the year and quarter of the working day in the
          format 'YYYY-Q'. It is useful for aggregating data on a quarterly
          basis.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: year
        description: >-
          This column represents the year of the working day. It is useful for
          aggregating data on an annual basis.
        data_type: int64
        meta:
          dimension:
            type: number
      - name: month
        description: >-
          This column represents the month of the year in numerical format
          (1-12), where 1 corresponds to January and 12 corresponds to December.
          It is useful for monthly trend analysis and comparisons.
        data_type: int64
        meta:
          dimension:
            type: number
      - name: month_day
        description: >-
          This column represents the specific day of the month. It is a
          combination of the month and the day, formatted as 'MM-DD'. This can
          be used to identify specific days for detailed daily analysis.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: day_of_week
        description: >-
          This column represents the day of the week, provided as a string
          (e.g., 'Monday', 'Tuesday', etc.). This can be used to analyze weekly
          trends or patterns, such as identifying the busiest or slowest days of
          the week.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: period
        description: >-
          This column represents the specific time period for which the data is
          relevant. It could be a specific day, week, month, or year. This
          information is crucial for understanding the temporal context of the
          data.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: period_code
        description: >-
          This column contains a unique code associated with each period. This
          code is used for internal tracking and data management purposes. It
          allows for efficient querying and sorting of data based on the time
          period.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
      - name: promotion
        description: >-
          This column indicates whether a promotion was active during the
          specified period. It provides insights into the marketing activities
          of the company and can be used to analyze the impact of promotions on
          business performance.
        data_type: string
        quote: true
        meta:
          dimension:
            type: string
