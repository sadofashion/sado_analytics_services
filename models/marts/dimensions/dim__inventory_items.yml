version: 2
models:
  - name: dim__inventory_items
    data_tests:
      - dbt_utils.unique_combination_of_columns:
            combination_of_columns:
              - extended_code
              - kiotviet_product_id
              - nhanhvn_product_id
    columns:
      - name: extended_code
        data_type: string
        quote: true
        description: ""
        meta:
          dimension:
            type: string
        
      - name: product_code
        description: >-
          This is a unique identifier for each product. It is used to track and
          manage inventory across different systems.
        meta:
          dimension:
            type: string
            hidden: true
        data_type: string
        
      - name: product_name
        description: >-
          This is the name of the product as it appears in the inventory. It is
          used for easy identification of products and is usually descriptive of
          the product's features or uses.
        meta:
          dimension:
            type: string
        data_type: string
      - name: product_design_code
        data_type: string
        quote: true
        description: ""
        meta:
          dimension:
            type: string
      - name: class_name
        description: >-
          This column represents the name of the product class. It is a
          categorical variable that helps in grouping similar types of products
          together. This can be useful for inventory management and product
          categorization.
        meta:
          dimension:
            type: string
            hidden: true
        data_type: string
      - name: sub_productline
        description: >-
          This column represents the subcategory within a product line. It
          provides a more granular level of product categorization, allowing for
          more specific product identification and management.
        meta:
          dimension:
            type: string
            hidden: true
          additional_dimensions:
            d_sub_product_line:
              label: Sub Productline
              type: string
              sql: coalesce(${TABLE}.sub_productline, 'Chưa phân loại')
        data_type: string
      - name: productline
        description: >-
          This column represents the main product line or category. It is a
          broad classification of the product, which helps in understanding the
          overall product assortment and aids in strategic decision making
          related to product management.
        meta:
          dimension:
            type: string
            hidden: true
          additional_dimensions:
            d_productline:
              label: Productline
              type: string
              sql: coalesce(${TABLE}.productline, 'Chưa phân loại')
        data_type: string
      - name: ads_product_mapping
        description: >-
          This column contains the mapping of the product with the
          advertisements. It helps in tracking the performance of the product in
          different ad campaigns and understanding the impact of advertising on
          product sales.
        meta:
          dimension:
            type: string
            hidden: true
          additional_dimensions:
            d_ads_product_mapping:
              label: ads product mapping
              type: string
              sql: coalesce(${TABLE}.ads_product_mapping, "CHƯA PHÂN LOẠI")
        data_type: string
      - name: category
        description: >-
          This column represents the category of the product. The category can
          be used to compare similar products and understand market trends.
        meta:
          dimension:
            type: string
            hidden: true
        data_type: string
      - name: kiotviet_product_id
        description: "This is a unique identifier for each product in the KiotViet system. "
        meta:
          dimension:
            type: number
            hidden: true
        data_type: numeric
      - name: nhanhvn_product_id
        description: "This is a unique identifier for each product in the Nhanh.vn system. "
        meta:
          dimension:
            type: number
            hidden: true
        data_type: int64
      - name: class_code
        description: >-
          This is a code that categorizes products into different classes. It is
          used for organizing products and can be helpful in understanding the
          product's nature or its place within the overall product range.
        meta:
          dimension:
            type: string
            hidden: true
        data_type: string
      - name: category_name
        meta:
          dimension:
            type: string
          additional_dimensions:
            d_category_name:
              type: string
              sql: coalesce(${TABLE}.category_name, "CHƯA PHÂN LOẠI")
              label: Category Name
        data_type: string
        description: ""
      - name: product_group
        description: >-
          This column represents the group to which the product belongs. It is a
          broader classification of the product, which helps in categorizing
          similar products under one umbrella for better management and
          analysis.
        meta:
          dimension:
            type: string
            hidden: true
          additional_dimensions:
            d_product_group:
              label: Product group
              type: string
              sql: coalesce(${TABLE}.product_group, "CHƯA PHÂN LOẠI")
        data_type: string
      - name: season
        meta:
          dimension:
            type: string
            hidden: true
          additional_dimensions:
            d_season:
              type: string
              sql: >-
                case 
                  when ${TABLE}.season = 'XUÂN HÈ' then '3.XUÂN HÈ' 
                  when ${TABLE}.season = 'THU ĐÔNG' then '1.THU ĐÔNG' 
                  when ${TABLE}.season = 'QUANH NĂM' then '2.QUANH NĂM' 
                  else coalesce(${TABLE}.season, "CHƯA PHÂN LOẠI") end
              label: Seasonal
        data_type: string
        description: ""
      - name: year
        description: ""
        meta:
          dimension:
            type: string
            hidden: true
          additional_dimensions:
            d_year:
              type: string
              sql: case when ${TABLE}.year not in ('24','23') then 'Cũ' else coalesce(${TABLE}.year,'Cũ') end
              label: Year
      - name: color_code
        description: ""
        meta:
          dimension:
            type: string
      - name: size_code
        description: ""
        meta:
          dimension:
            type: string
      - name: form_code
        description: ""
        meta:
          dimension:
            type: string
      - name: weaving_method_code
        description: ""
        meta:
          dimension:
            type: string
    description: >-
      The 'dim__inventory_items' model is a comprehensive view of the inventory
      items, combining data from kiotviet and nhanhvn. This model excludes items
      from the 'NGUYÊN PHỤ LIỆU' product line and 'Combo' type.
