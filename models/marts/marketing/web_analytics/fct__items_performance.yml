version: 2
models:
  - name: fct__items_performance
    meta:
      joins:
        - join: dim__web_items
          sql_on: ${dim__web_items.product_code} = ${fct__items_performance.item_id}
        - join: dim__sessions
          sql_on: ${dim__sessions.session_key} = ${fct__items_performance.session_key}
        - join: dim__client_keys
          sql_on: ${dim__client_keys.client_key} = ${fct__items_performance.client_key}
        - join: calendar
          sql_on: ${calendar.date} = ${fct__items_performance.event_date_dt}
    columns:
      - name: item_id
        description: ""
        meta:
          dimension:
            type: string
            hidden: true
        data_type: STRING
      - name: client_key
        description: ""
        meta:
          dimension:
            type: string
            hidden: true
        data_type: STRING
      - name: session_key
        description: ""
        meta:
          dimension:
            type: string
            hidden: true
        data_type: STRING
      - name: event_date_dt
        description: ""
        meta:
          dimension:
            type: date
            hidden: true
        data_type: DATE
      - name: item_variant
        description: The variant of the item in the format Color | Size
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: coupon
        description: The coupon code that was used during the purchase
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: promotion_name
        description: The name of the promotion applied to the item
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: payment_type
        description: ""
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: delivery_method
        description: ""
        meta:
          dimension:
            type: string
        data_type: STRING
      - name: num_purchase
        description: This column represents the count of unique purchases made for a
          particular item
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_num_purchase:
              type: sum
              label: "# Purchases"
              compact: thousands
              round: 1
            m_purchase_to_atc_rate:
              type: number
              sql: safe_divide(${m_num_purchase}, ${m_num_add_to_cart})
              label: "Purchase To ATC Rate"
              format: percent
              round: 1
            m_purchase_rate:
              type: number
              sql: safe_divide(${m_num_purchase}, ${m_num_view_item})
              label: "Purchase Rate"
              format: percent
              round: 1
        data_type: INT64
      - name: total_purchase_quantity
        description: total quantity of a particular item purchased
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_total_purchase_quantity:
              type: sum
              label: "Total Purchase Quantity"
              round: 0
        data_type: INT64
      - name: avg_purchase_price
        description: average price at which a particular item was purchased
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_avg_purchase_price:
              type: average
              label: "Average Purchase Price"
              compact: thousands
              round: 1
        data_type: FLOAT64
      - name: num_view_item
        description: the count of unique view events for each item
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_num_view_item:
              type: sum
              label: "# View Items"
              compact: thousands
              round: 1
        data_type: INT64
      - name: total_view_item_quantity
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
        data_type: INT64
      - name: avg_view_item_price
        description: average price of the viewed items
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_avg_view_item_price:
              type: average
              label: "Average View Item Price"
              compact: thousands
              round: 1
        data_type: FLOAT64
      - name: num_add_to_cart
        description: count of unique events where an item was added to the cart
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_num_add_to_cart:
              type: sum
              label: "# Add to Cart"
              compact: thousands
              round: 1
            m_add_to_cart_rate:
              type: number
              label: "Add to Cart Rate"
              sql: safe_divide(${m_num_add_to_cart}, ${m_num_view_item})
              round: 2
              format: percent
        data_type: INT64
      - name: total_add_to_cart_quantity
        description: total quantity of items that were added to the cart
        meta:
          dimension:
            type: number
            hidden: true
        data_type: INT64
      - name: avg_add_to_cart_price
        description: average price of items that were added to the cart
        meta:
          dimension:
            type: number
            hidden: true
        data_type: FLOAT64
      - name: num_orders
        description: total number of unique orders placed
        meta:
          dimension:
            type: number
            hidden: true
        data_type: INT64
      - name: total_item_revenue
        description: total revenue generated from the sale of items
        meta:
          dimension:
            type: number
            hidden: true
        data_type: FLOAT64
      - name: total_shipping
        description: total shipping cost for all the items
        meta:
          dimension:
            type: number
            hidden: true
        data_type: INT64
      - name: total_tax
        description: total tax amount for all transactions associated with a specific item
        meta:
          dimension:
            type: number
            hidden: true
        data_type: INT64
    description: The fct__items_performance model provides a detailed view of the
      performance of items in the e-commerce store.
