version: 2
models:
  - name: dim__location_groups
    meta:
      joins:
        - join: calendar
          sql_on: ${calendar.date} >= ${dim__location_groups.opening_day}
          type: full
          always: true
    columns:
      - name: local_page_code
        description: ""
        meta:
          dimension:
            type: string
        tests:
          - unique
          - not_null
      - name: local_page
        description: ""
        meta:
          dimension:
            type: string
      - name: region
        description: ""
        meta:
          dimension:
            type: string
      - name: province
        description: ""
        meta:
          dimension:
            type: string
      - name: asm_name
        description: ""
        meta:
          dimension:
            type: string
      - name: fb_ads_pic
        description: ""
        meta:
          dimension:
            type: string
      - name: opening_day
        description: ""
        meta:
          dimension:
            type: date
            hidden: true
          additional_dimensions:
            d_opening:
              type: string
              label: CH Khai trương
              sql: >
                case when date_diff( ${calendar.date},${TABLE}.opening_day,day) <10 then "CH khai trương" else 'Đã khai trương' end
      - name: close_date
        description: ""
        meta:
          dimension:
            type: date
            hidden: true
