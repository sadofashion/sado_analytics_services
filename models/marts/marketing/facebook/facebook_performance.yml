version: 2
models:
  - name: facebook_performance
    description: ""
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date_start
            - ad_key
    meta:
      joins:
        - join: calendar
          sql_on: ${facebook_performance.date_start} = ${calendar.date}
        - join: stg_facebookads__accounts
          sql_on: >-
            ${stg_facebookads__accounts.account_id} =
            ${facebook_performance.account_id}
        - join: dim__campaigns
          sql_on: ${dim__campaigns.ad_key} = ${facebook_performance.ad_key}
    columns:
      - name: date_start
        description: ""
        meta:
          dimension:
            type: date
            hidden: true
      - name: impressions
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_impressions:
              type: sum
              label: Impressions
              group_label: FB Ads
              compact: millions
              round: 1
            m_avg_impressions:
              type: average
              label: AVG Impressions
              group_label: FB Ads
              compact: millions
              round: 1
      - name: spend
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_spend:
              type: sum
              label: Spend
              group_label: FB Ads
              compact: millions
              round: 1
            m_avg_spend:
              type: average
              label: Avg Spend
              group_label: FB Ads
              compact: millions
              round: 1
      - name: clicks
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_clicks:
              type: sum
              label: Clicks
              group_label: FB Ads
              compact: thousands
              round: 1
      - name: reach
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_reach:
              type: average
              label: Reach
              group_label: FB Ads
              compact: thousands
              round: 1
      - name: link_click
        description: number of clicks to any urls in ads
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_link_click:
              type: sum
              label: Link Clicks
              group_label: FB Ads
              compact: thousands
              round: 1
      - name: post_engagement
        description: number of engagement with ad post
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_post_engagement:
              type: sum
              label: Post engagement
              group_label: FB Ads
              compact: thousands
              round: 1
      - name: offline_conversion_purchase
        description: number of offline purchases attributed to ads
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_ocv:
              type: sum
              label: Offine CV Purchase
              group_label: FB Ads
              compact: thousands
              round: 1
      - name: offline_conversion_purchase_value
        description: offline purchase value attributed to ads
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_ocv_value:
              type: sum
              label: Offline CV Value
              group_label: FB Ads
              compact: millions
              round: 1
      - name: pixel_purchase
        description: website purchase attributed to ads
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_pcv:
              type: sum
              label: Online CV
              group_label: FB Ads
              compact: thousands
              round: 1
      - name: pixel_purchase_value
        description: website purchase value attributed to ads
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_pcv_value:
              type: sum
              label: Online CV Value
              group_label: FB Ads
              compact: millions
              round: 1
      - name: meta_purchase
        description: number of purchase generated directly on facebook
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_meta_purchase:
              type: sum
              label: Message CV
              group_label: FB Ads
              compact: thousands
              round: 1
      - name: meta_purchase_value
        description: purchase value generated directly on facebook
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_meta_purchase_value:
              type: sum
              label: Message CV Value
              group_label: FB Ads
              compact: millions
              round: 1
      - name: _results_message
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
          metrics:
            m_messages:
              type: sum
              label: Messages
              group_label: FB Ads
              compact: thousands
              round: 1
      - name: account_id
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
      - name: ad_key
        description: ""
        meta:
          dimension:
            type: string
