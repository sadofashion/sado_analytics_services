version: 2
models:
  - name: fct__post_insights
    meta:
      joins:
        - join: calendar
          sql_on: >-
            date(${fct__post_insights.metric_time}) = ${calendar.date} and
            ${fct__post_insights.aggregate_period} = 'day'
        - join: dim__posts
          sql_on: ${fct__post_insights.post_id} = ${dim__posts.post_id}
        - join: dim__pages
          sql_on: ${fct__post_insights.page_id} = ${dim__pages.page_id}
    columns:
      - name: metric_id
        description: The unique identifier for each metric. This is a primary key.
        meta:
          dimension:
            type: string
            hidden: true
        data_type: string
      - name: post_id
        description: >-
          The unique identifier for each post. This is a foreign key that links
          to the post table.
        meta:
          dimension:
            type: string
            hidden: true
        data_type: string
      - name: metric_name
        description: >-
          The name of the metric. This is a descriptive field that indicates the
          type of metric being recorded.
        meta:
          dimension:
            type: string
        data_type: string
      - name: aggregate_period
        description: >-
          The 'aggregate_period' column represents the time period over which
          the metric is aggregated. This could be daily, weekly, monthly, etc.
        meta:
          dimension:
            type: string
            hidden: true
        data_type: string
      - name: metric_title
        description: >-
          The 'metric_title' column contains the title of the metric being
          reported. This could be any metric related to post insights such as
          'post_engagement', 'post_reach', etc.
        meta:
          dimension:
            type: string
        data_type: string
      - name: metric_description
        description: >-
          The 'metric_description' column provides a detailed description of
          what the metric represents. This helps users understand the context
          and significance of the metric.
        meta:
          dimension:
            type: string
        data_type: string
      - name: metric_time
        description: >-
          The 'metric_time' column represents the timestamp at which the metric
          was recorded. It is of type TIMESTAMP and is in UTC.
        meta:
          dimension:
            type: timestamp
        data_type: timestamp
      - name: metric_value
        description: >-
          The 'metric_value' column represents the value of the metric recorded.
          It is of type FLOAT and can contain decimal values.
        meta:
          dimension:
            type: number
          metrics:
            m_clicks:
              type: sum
              label: Clicks
              compact: thousands
              round: 1
              filters:
                - metric_name: post_clicks
            m_impressions:
              type: sum
              label: Impressions
              compact: thousands
              round: 1
              filters:
                - metric_name: post_impressions
            m_clicks_unique:
              type: sum
              label: Unique Clicks
              compact: thousands
              round: 1
              filters:
                - metric_name: post_clicks_unique
            m_paid_impressions:
              type: sum
              label: Paid Impressions
              compact: thousands
              round: 1
              filters:
                - metric_name: post_impressions_paid
            m_organic_impressions:
              type: sum
              label: Organic Impressions
              compact: thousands
              round: 1
              filters:
                - metric_name: post_impressions_organic
            m_viral_impressions:
              type: sum
              label: Viral Impressions
              compact: thousands
              round: 1
              filters:
                - metric_name: post_impressions_viral
            m_click_rate:
              type: number
              label: Click Rate
              format: percent
              round: 2
              sql: safe_divide(${m_clicks}, ${m_impressions})
            m_paid_click_rate:
              type: number
              label: Paid Click Rate
              format: percent
              round: 2
              sql: safe_divide(${m_clicks}, ${m_paid_impressions})
            m_engaged_users:
              type: sum
              label: Engaged Users
              compact: thousands
              round: 1
              filters:
                - metric_name: post_engaged_users
            m_unique_impressions:
              type: sum
              label: Reach
              compact: thousands
              round: 1
              filters:
                - metric_name: post_impressions_unique
            m_engagement_rate:
              type: number
              label: Engagement Rate
              format: percent
              round: 2
              sql: safe_divide(${m_engaged_users}, ${m_unique_impressions})
        data_type: float64
      - name: page_id
        description: ""
        meta:
          dimension:
            type: string
            hidden: true
    description: >-
      The model is a fact table that contains metrics related to Facebook post
      insights
