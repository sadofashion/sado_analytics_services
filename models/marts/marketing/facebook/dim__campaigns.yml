version: 2
models:
  - name: dim__campaigns
    meta:
      joins:
        - join: dim__pages
          sql_on: ${dim__campaigns}.ad_page_id = dim__pages.page_id
          always: true
        - join: dim__ad_accounts
          sql_on: ${dim__campaigns}.account_id = dim__ad_accounts.account_id
          always: true
    columns:
      - name: account_id
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
      - name: campaign_name
        description: ""
        meta:
          dimension:
            type: string
      - name: adset_name
        description: ""
        meta:
          dimension:
            type: string
      - name: ad_name
        description: ""
        meta:
          dimension:
            type: string
      - name: campaign_id
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
      - name: adset_id
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
      - name: ad_id
        description: ""
        meta:
          dimension:
            type: number
            hidden: true
      - name: convention_version_number
        description: ""
        meta:
          dimension:
            type: string
      - name: channel
        description: ""
        meta:
          dimension:
            type: string
      - name: ad_location_layer
        description: ""
        meta:
          dimension:
            type: string
      - name: campaign_category
        description: ""
        meta:
          dimension:
            type: string
      - name: event_name
        description: ""
        meta:
          dimension:
            type: string
          additional_dimensions:
            d_opening:
              type: string
              sql: case when ${TABLE}.event_name in ("KHAI TRƯƠNG","KT") then "CH khai trương" else "Đã khai trương" end
              label: Opening
      - name: content_edge
        description: ""
        meta:
          dimension:
            type: string
      - name: ad_pic
        description: ""
        meta:
          dimension:
            type: string
      - name: audience_type
        description: ""
        meta:
          dimension:
            type: string
      - name: target_method
        description: ""
        meta:
          dimension:
            type: string
      - name: original_audience_name
        description: ""
        meta:
          dimension:
            type: string
      - name: audience_demographic
        description: ""
        meta:
          dimension:
            type: string
      - name: audience_region
        description: ""
        meta:
          dimension:
            type: string
      - name: audience_source_name
        description: ""
        meta:
          dimension:
            type: string
      - name: media_type
        description: ""
        meta:
          dimension:
            type: string
      - name: content_code
        description: ""
        meta:
          dimension:
            type: string
      - name: ad_location
        description: ""
        meta:
          dimension:
            type: string
      - name: ad_key
        description: ""
        meta:
          dimension:
            type: string
        tests:
          - unique
          - not_null
      - name: brand_name
        description: ""
        meta:
          dimension:
            type: string
      - name: ad_group_location
        description: ""
        meta:
          dimension:
            type: string
      - name: province
        description: ""
        meta:
          dimension:
            type: string
      - name: region
        description: ""
        meta:
          dimension:
            type: string
      - name: country
        description: ""
        meta:
          dimension:
            type: string
      - name: content_edge_group
        description: ""
        meta:
          dimension:
            type: string
      - name: category_name
        description: ""
        meta:
          dimension:
            type: string
      - name: product_group
        description: ""
        meta:
          dimension:
            type: string
      - name: season
        description: ""
        meta:
          dimension:
            type: string
            hidden: true
          additional_dimensions:
            d_season:
              type: string
              sql: case when ${TABLE}.season in ("XUÂN HÈ","THU ĐÔNG","QUANH NĂM", "PHỤ KIỆN") then ${TABLE}.season else "KHÁC" end
              label: Seasonal
