version: 2
models:
  - name: dim__campaigns
    meta:
      joins:
        - join: dim__pages
          sql_on: ${dim__campaigns.ad_page_id} = ${dim__pages.page_id}
          always: true
        - join: dim__ad_accounts
          sql_on: ${dim__campaigns.account_id} = ${dim__ad_accounts.account_id}
          always: true
    columns:
      - name: account_id
        meta:
          dimension:
            type: number
            hidden: true
        data_type: string
      - name: campaign_name
        meta:
          dimension:
            type: string
        data_type: string
      - name: adset_name
        meta:
          dimension:
            type: string
        data_type: string
      - name: ad_name
        meta:
          dimension:
            type: string
        data_type: string
      - name: campaign_id
        meta:
          dimension:
            type: number
            hidden: true
        data_type: string
      - name: adset_id
        meta:
          dimension:
            type: number
            hidden: true
        data_type: string
      - name: ad_id
        meta:
          dimension:
            type: number
            hidden: true
        data_type: string
      - name: ad_key
        meta:
          dimension:
            type: string
        data_type: string
        data_tests:
          - not_null
          - unique
      - name: convention_version_number
        meta:
          dimension:
            type: string
        data_type: string
      - name: channel
        meta:
          dimension:
            type: string
        data_type: string
      - name: brand_name
        meta:
          dimension:
            type: string
        data_type: string
      - name: ad_location_layer
        meta:
          dimension:
            type: string
        data_type: string
      - name: campaign_category
        meta:
          dimension:
            type: string
        data_type: string
      - name: content_edge
        meta:
          dimension:
            type: string
        data_type: string
      - name: audience_type
        meta:
          dimension:
            type: string
        data_type: string
      - name: target_method
        meta:
          dimension:
            type: string
        data_type: string
      - name: original_audience_name
        meta:
          dimension:
            type: string
        data_type: string
      - name: audience_demographic
        meta:
          dimension:
            type: string
        data_type: string
      - name: audience_region
        meta:
          dimension:
            type: string
        data_type: string
      - name: audience_source_name
        meta:
          dimension:
            type: string
        data_type: string
      - name: media_type
        meta:
          dimension:
            type: string
        data_type: string
      - name: content_code
        meta:
          dimension:
            type: string
        data_type: string
      - name: content_edge_group
        meta:
          dimension:
            type: string
        data_type: string
      - name: event_name
        meta:
          dimension:
            type: string
          additional_dimensions:
            d_opening:
              type: string
              sql: case when ${TABLE}.event_name in ("KHAI TRƯƠNG","KT") then "CH khai trương"
                else "Đã khai trương" end
              label: Opening
        data_type: string
      - name: ad_location
        meta:
          dimension:
            type: string
        data_type: string
      - name: ad_group_location
        meta:
          dimension:
            type: string
        data_type: string
      - name: province
        meta:
          dimension:
            type: string
        data_type: string
      - name: region
        meta:
          dimension:
            type: string
        data_type: string
      - name: country
        meta:
          dimension:
            type: string
        data_type: string
      - name: ad_pic
        meta:
          dimension:
            type: string
        data_type: string
      - name: category_name
        meta:
          dimension:
            type: string
        data_type: string
      - name: product_group
        meta:
          dimension:
            type: string
        data_type: string
      - name: season
        meta:
          dimension:
            type: string
            hidden: true
          additional_dimensions:
            d_season:
              type: string
              sql: case when ${TABLE}.season in ("XUÂN HÈ","THU ĐÔNG","QUANH NĂM", "PHỤ KIỆN")
                then ${TABLE}.season else "CHƯA PHÂN LOẠI" end
              label: Seasonal
        data_type: string
      - name: ad_page_id
        data_type: string
        quote: true
